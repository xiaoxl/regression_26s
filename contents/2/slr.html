<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.9.12">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Simple Linear regression ‚Äì Regression 26 Spring</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../contents/2/rcode.html" rel="next">
<link href="../../contents/2/intro.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-76bd60113cab0e4045c5a075e28c35eb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-bd72660a7ac1d74eb59e6013565e57c7.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-76bd60113cab0e4045c5a075e28c35eb.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-18c4c02f2e0c35b6cc6a137a251bffe3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-98d67fd4a94d75c92ed86be1e8f4ff03.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-18c4c02f2e0c35b6cc6a137a251bffe3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/bookup_fonts_gwf-0.0/fonts-embed.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/blocks.css">
</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simple Linear regression</span></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Regression 26 Spring</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Review</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/1/basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/1/prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/1/inferences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Inferences</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Simple Linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/2/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intro to regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/2/slr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simple Linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/2/rcode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/2/project1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Example: SLR phase</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Multiple Linear regression</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/3/mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multiple Linear regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Quick intro to R</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#slr" id="toc-slr" class="nav-link active" data-scroll-target="#slr"><span class="header-section-number">5.1</span> SLR</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation"><span class="header-section-number">5.2</span> Estimation</a>
  <ul class="collapse">
  <li><a href="#ols-estimators" id="toc-ols-estimators" class="nav-link" data-scroll-target="#ols-estimators"><span class="header-section-number">5.2.1</span> OLS estimators</a></li>
  <li><a href="#mle-estimators" id="toc-mle-estimators" class="nav-link" data-scroll-target="#mle-estimators"><span class="header-section-number">5.2.2</span> MLE estimators</a></li>
  <li><a href="#properties-of-these-estimators" id="toc-properties-of-these-estimators" class="nav-link" data-scroll-target="#properties-of-these-estimators"><span class="header-section-number">5.2.3</span> Properties of these estimators</a></li>
  </ul></li>
  <li><a href="#beta_1" id="toc-beta_1" class="nav-link" data-scroll-target="#beta_1"><span class="header-section-number">5.3</span> <span class="math inline">\(\beta_1\)</span></a>
  <ul class="collapse">
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link" data-scroll-target="#confidence-interval"><span class="header-section-number">5.3.1</span> Confidence interval</a></li>
  </ul></li>
  <li><a href="#sum-of-squares" id="toc-sum-of-squares" class="nav-link" data-scroll-target="#sum-of-squares"><span class="header-section-number">5.4</span> Sum of squares</a></li>
  <li><a href="#coefficient-of-determination" id="toc-coefficient-of-determination" class="nav-link" data-scroll-target="#coefficient-of-determination"><span class="header-section-number">5.5</span> Coefficient of Determination</a></li>
  <li><a href="#coefficent-of-correlation" id="toc-coefficent-of-correlation" class="nav-link" data-scroll-target="#coefficent-of-correlation"><span class="header-section-number">5.6</span> Coefficent of Correlation</a></li>
  <li><a href="#the-anova-table" id="toc-the-anova-table" class="nav-link" data-scroll-target="#the-anova-table"><span class="header-section-number">5.7</span> The ANOVA table</a></li>
  <li><a href="#prediction-interval-and-confidence-interval" id="toc-prediction-interval-and-confidence-interval" class="nav-link" data-scroll-target="#prediction-interval-and-confidence-interval"><span class="header-section-number">5.8</span> Prediction interval and Confidence interval</a>
  <ul class="collapse">
  <li><a href="#estimate-the-variance" id="toc-estimate-the-variance" class="nav-link" data-scroll-target="#estimate-the-variance"><span class="header-section-number">5.8.1</span> Estimate the variance</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simple Linear regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<!-- Constants and basic symbols -->
<p><span class="math display">\[
\require{physics}
\require{braket}
\]</span></p>
<p><span class="math display">\[
\newcommand{\dl}[1]{{\hspace{#1mu}\mathrm d}}
\newcommand{\me}{{\mathrm e}}
\newcommand{\argmin}{\operatorname{argmin}}
\]</span></p>
<!-- Probability -->
<p>$$ </p>
<p> $$</p>
<!-- Distributions pdf -->
<p><span class="math display">\[
\newcommand{\pdfbinom}{{\tt binom}}
\newcommand{\pdfbeta}{{\tt beta}}
\newcommand{\pdfpois}{{\tt poisson}}
\newcommand{\pdfgamma}{{\tt gamma}}
\newcommand{\pdfnormal}{{\tt norm}}
  \newcommand{\pdfexp}{{\tt expon}}
\]</span></p>
<!-- Distributions -->
<p><span class="math display">\[
\newcommand{\distbinom}{\operatorname{B}}
\newcommand{\distbeta}{\operatorname{Beta}}
\newcommand{\distgamma}{\operatorname{Gamma}}
\newcommand{\distexp}{\operatorname{Exp}}
\newcommand{\distpois}{\operatorname{Poisson}}
\newcommand{\distnormal}{\operatorname{\mathcal N}}
\]</span></p>
</div>
<section id="slr" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="slr"><span class="header-section-number">5.1</span> SLR</h2>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.1 (A First-Order Model)</strong></span> <span class="math display">\[
y=\beta_0+\beta_1x+\varepsilon
\]</span> where</p>
<ul>
<li><span class="math inline">\(y\)</span>: The <strong>response</strong> variable</li>
<li><span class="math inline">\(x\)</span>: The <strong>independent</strong> variable (variable used as a <strong>predictor</strong> of <span class="math inline">\(y\)</span>)</li>
<li><span class="math inline">\(\operatorname{E}(y)=\beta_0+\beta_1x\)</span>: Deterministic component</li>
<li><span class="math inline">\(\varepsilon\)</span>: Random error component</li>
<li><span class="math inline">\(\beta_0\)</span>: <strong><span class="math inline">\(y\)</span>-intercept</strong></li>
<li><span class="math inline">\(\beta_1\)</span>: <strong>Slope</strong></li>
</ul>
<p>For <span class="math inline">\(\varepsilon\)</span>, we have the following assumptions:</p>
<ul>
<li><span class="math inline">\(\varepsilon\)</span> follows Normal distribution for all <span class="math inline">\(x\)</span>.</li>
<li>The mean is constant to be <span class="math inline">\(0\)</span>.</li>
<li>The variance is constant <span class="math inline">\(\sigma^2\)</span> (homoscedastic).</li>
<li>The errors associated with two observations are independent.</li>
</ul>
<p>In other words, <span class="math inline">\(\varepsilon_i\sim N(0,\sigma^2)\)</span> i.i.d.</p>
</div>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.2 (Regression equation)</strong></span> Simple linear regression equation is <span class="math display">\[
\operatorname{E}(y)=\beta_0+\beta_1x.
\]</span></p>
</div>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.3 (Estimated regression equation)</strong></span> The estimated simple linear regression equation is <span class="math display">\[
\hat y=\hat\beta_0+\hat\beta_1x.
\]</span> <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> are estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
</div>
<p>The purpose of the section is to estimate <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> as well as <span class="math inline">\(\sigma^2\)</span>.</p>
<!-- 
### Fitting the model

MLE=LSE under the assumption that $\epsilon$ is normal


different estimators 




first assuming that $\sigma$ is constant.



- Sum of squares of deviations for the $x$s: $SS_{xx}=\sum(x_i-\bar{x})^2$
- Sum of squares of deviations for the $y$s: $SS_{yy}=\sum(y_i-\bar{y})^2$
- Sum of cross-products: $SS_{xy}=\sum(x_i-\bar{x})(y_i-\bar{y})$



::: {#thm-}
Estimate $\beta_0$, $\beta_1$ and $\sigma^2$. The NLL is
$$
NLL = -\frac{n}{2}\ln\qty(2\pi\sigma^2)-\frac{1}{2\sigma^2}\sum\qty(y_i-\beta_0-\beta_1x_i)^2.
$$
:::


::: {.solution}
$$
\begin{split}
\pdv{NLL}{\beta_0}&=
\end{split}
$$
::: -->
</section>
<section id="estimation" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="estimation"><span class="header-section-number">5.2</span> Estimation</h2>
<!-- b0, b1 are estimations

1. b0, b1 formula
2. E(b0) E(b1)
3. Var(b0), Var(b1)
4. relations to y: b1, ybar independent, b0, b1 are independent -->
<section id="ols-estimators" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="ols-estimators"><span class="header-section-number">5.2.1</span> OLS estimators</h3>
<p>The standard approach is known as ordinary least squares (OLS) estimation. In this method, model parameters are chosen to minimize the sum of squared residuals between the observed responses and the values predicted by the model. From an optimization perspective, OLS minimizes a loss function that measures the discrepancy between the data and the fitted model.</p>
<p>Here are more details.</p>
<p>Consider the linear regression model <span class="math display">\[
y_i=\beta_0+\beta_1x_i+\varepsilon_i,\quad i=1,\ldots, n.
\]</span></p>
<p>In order to find the best parameters, we need to minimize the sum of squared errors <span class="math display">\[
L(\beta_0, \beta_1) = \sum_{i=1}^n\varepsilon_i^2=\sum_{i=1}^n(y_i-\beta_0-\beta_1x_i)^2.
\]</span></p>
<p>In other words,</p>
<p><span class="math display">\[
\hat\beta_0,\hat\beta_1=\argmin_{\beta_0,\beta_1}L(\beta_0, \beta_1)=\argmin_{\beta_0,\beta_1}\sum_i^n(y_i-\beta_0-\beta_1x_i)^2.
\]</span></p>
<p>Since this loss can be treated as a function of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, to minimize it, we could consider the critical point, which is</p>
<p><span class="math display">\[
\pdv{L}{\beta_0}=0,\quad \pdv{L}{\beta_1}=0.
\]</span> In other words, we have</p>
<p><span class="math display">\[
\begin{split}
\pdv{L}{\beta_0}&amp;=\sum_{i=1}^n2(y_i-\beta_0-\beta_1x_i)(-1)=-2\qty(\sum_{i=1}^ny_i-n\beta_0-\beta_1(\sum_{i=1}^nx_i))=-2n(\bar y-\beta_0-\beta_1\bar x)=0,\\
\pdv{L}{\beta_1}&amp;=\sum_{i=1}^n2(y_i-\beta_0-\beta_1x_i)(-x_i).
\end{split}
\]</span> The first equation gives us <span class="math inline">\(\beta_0=\bar y-\beta_1\bar x\)</span>. Then the second equation is <span class="math display">\[
\begin{split}
\pdv{L}{\beta_1}&amp;=\sum_{i=1}^n2(y_i-\beta_0-\beta_1x_i)(-x_i)=-2\sum_{i=1}^n(y_i-\bar y+\beta_1\bar x-\beta_1x_i)(x_i)\\
&amp;=-2\sum_{i=1}^n(y_i-\bar y-\beta_1(x_i-\bar x))(x_i)=-2\sum_{i=1}^n(y_i-\bar y-\beta_1(x_i-\bar x))(x_i-\bar x)\\
&amp;=-2\qty(\sum_{i=1}^n(y_i-\bar y)(x_i-\bar x)-\beta_1\sum_{i=1}^n(x_i-\bar x)(x_i-\bar x))\\
&amp;=-2\qty(SS_{xy}-\beta_1SS_{xx})=0.
\end{split}
\]</span></p>
<p>Therefore, the solution to the equations, which is the best parameters that minimize the sum of square errors, is</p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.1</strong></span> <span class="math display">\[
\hat{\beta}_1=\frac{SS_{xy}}{SS_{xx}},\quad \hat{\beta}_0=\bar{y}-\hat{\beta}_1\bar{x}.
\]</span></p>
</div>
</section>
<section id="mle-estimators" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="mle-estimators"><span class="header-section-number">5.2.2</span> MLE estimators</h3>
<p>Since we assume <span class="math inline">\(\varepsilon_i\sim \mathcal N(0,\sigma^2)\)</span> i.i.d, we could actually compute the likelihood function explicitly. Recall that <span class="math inline">\(y_i=\beta_0+\beta_1x_i+\varepsilon_i\)</span>, then <span class="math display">\[
\begin{split}
p(y_i\mid x_i,\beta_0,\beta_1,\sigma^2)=\frac{1}{\sqrt{2\pi \sigma^2}}\exp\qty(-\frac{(y_i-\beta_0-\beta_1x_i)^2}{2\sigma^2}).
\end{split}
\]</span> Take all data into consideration. Let <span class="math inline">\(\mathbf x=(x_1,\ldots,x_n)\)</span> and <span class="math inline">\(\mathbf y=(y_1,\ldots,y_n)\)</span>. Assuming that all <span class="math inline">\(\varepsilon_i\)</span>‚Äôs are independent, then the likelihood function is <span class="math display">\[
L(\beta_0,\beta_1,\sigma^2\mid \mathbf x, \mathbf y)=\prod_{i=1}^n\frac1{\sqrt{2\pi\sigma^2}}\exp\qty(-\frac{(y_i-\beta_0-\beta_1x_i)^2}{2\sigma^2}).
\]</span> We could take negative log to make it simpler <span class="math display">\[
\operatorname{nll}(\beta_0,\beta_1,\sigma^2\mid \mathbf x, \mathbf y)=\frac n2\ln\qty(2\pi\sigma^2)+\frac1{2\sigma^2}\sum_{i=1}^n(y_i-\beta_0-\beta_1x_i)^2.
\]</span> This derived loss function is called the negative log-likelihood (NLL). Maximizing the likelihood is equivalent to minimizing <span class="math inline">\(\operatorname{nll}\)</span>.</p>
<p>For fixed <span class="math inline">\(\sigma^2\)</span>, minimizing <span class="math inline">\(\operatorname{nll}\)</span> over <span class="math inline">\((\beta_0,\beta_1)\)</span> is equivalent to minimizing <span class="math inline">\(\sum_{i=1}^n(y_i-\beta_0-\beta_1x_i)^2\)</span>, so the MLE of <span class="math inline">\((\beta_0,\beta_1)\)</span> is the same as the OLS estimator.</p>
<p>To estimate <span class="math inline">\(\sigma^2\)</span>, treat <span class="math inline">\(\sigma^2\)</span> as a variable and differentiate: <span class="math display">\[
\pdv{\operatorname{nll}}{\sigma^2}=\frac{n}2\frac1{\sigma^2}-\frac12\frac{1}{(\sigma^2)^2}\sum_{i=1}^n(y_i-\beta_0-\beta_1x_i)^2=0.
\]</span> Setting this derivative to zero yields</p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.2</strong></span> <span class="math display">\[
\hat\sigma_{MLE}^2=\frac1n\sum_{i=1}^n(y_i-\hat\beta_0-\hat\beta_1x_i)^2=\frac{SSE}{n}.
\]</span></p>
</div>
<p>Similar to the sample variance scenario, the MLE estimator for variance is biased. The unbiased estimator of the error variance is the sample variance of the residuals. <span class="math display">\[
s^2=\frac{SSE}{n-2}.
\]</span></p>
</section>
<section id="properties-of-these-estimators" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="properties-of-these-estimators"><span class="header-section-number">5.2.3</span> Properties of these estimators</h3>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.3</strong></span> <span class="math display">\[
\operatorname{E}(\hat{\beta}_0)=\beta_0, \quad \operatorname{E}(\hat{\beta}_1)=\beta_1,\quad \operatorname{E}(s^2)=\sigma^2.
\]</span></p>
<details>
<summary>
<strong>Click for proof.</strong>
</summary>
<p>The key point is to treat all <span class="math inline">\(x_i\)</span>‚Äôs as constants, and <span class="math inline">\(y_i=\beta_0+\beta_1x_i+\varepsilon_i\)</span> is a random variable due to <span class="math inline">\(\varepsilon_i\)</span>. Note that <span class="math inline">\(\operatorname{E}(y_i)=\beta_0+\beta_1x_i\)</span> and <span class="math inline">\(\operatorname{E}(\bar y)=\frac1n\sum_{i=1}^n\operatorname{E}(y_i)=\beta_0+\beta_1\bar x\)</span>. <span class="math display">\[
\begin{split}
\operatorname{E}(SS_{xy})&amp;=\operatorname{E}\qty(\sum_{i=1}^n(x_i-\bar x)(y_i-\bar y))\\
&amp;=\sum_{i=1}^n(x_i-\bar x)(\operatorname{E}(y_i)-\operatorname{E}(\bar y))\\
&amp;=\sum_{i=1}^n(x_i-\bar x)(\beta_0+\beta_1x_i-\beta_0-\beta_1\bar x)\\
&amp;=\sum_{i=1}^n(x_i-\bar x)\beta_1(x_i-\bar x)\\
&amp;=\beta_1SS_{xx}.
\end{split}
\]</span> Therefore <span class="math display">\[
\operatorname{E}(\hat\beta_1)=\operatorname{E}\qty(\frac{SS_{xy}}{SS_{xx}})=\beta_1.
\]</span> We now show that <span class="math inline">\(\hat\beta_0\)</span> is an unbiased estimator of <span class="math inline">\(\beta_0\)</span>. Recall that <span class="math display">\[
\hat\beta_0 = \bar y - \hat\beta_1 \bar x.
\]</span> Taking expectations and using linearity of expectation, <span class="math display">\[
\begin{aligned}
\operatorname{E}(\hat\beta_0)
&amp;= \operatorname{E}(\bar y) - \bar x\,\operatorname{E}(\hat\beta_1) \\
&amp;= (\beta_0 + \beta_1 \bar x) - \bar x\,\beta_1 \\
&amp;= \beta_0.
\end{aligned}
\]</span> Therefore, <span class="math inline">\(\hat\beta_0\)</span> is an unbiased estimator of <span class="math inline">\(\beta_0\)</span>.</p>
<p>For <span class="math inline">\(s^2\)</span>, it requires more knowledge from <span class="math inline">\(\chi^22\)</span> distribution.</p>
<ul>
<li><span class="math inline">\(\varepsilon_i\sim \mathcal N(0,\sigma^2)\)</span> i.i.d, and <span class="math inline">\(x_i\)</span>‚Äôs are all constants.</li>
<li><span class="math inline">\(e_i=y_i-\hat y_i=\varepsilon_i-(\hat\beta_0-\beta_0)+(\hat\beta_1-\beta_1)x_i\)</span>. Note that <span class="math inline">\(\hat\beta_0-\beta_0\)</span> and <span class="math inline">\(\hat\beta_1-\beta_1\)</span> are functions of all <span class="math inline">\(\varepsilon_i\)</span>‚Äôs so each residual depends on the entire error vector.</li>
<li>Since <span class="math inline">\(SSE=\sum_{i=1}^ne_i^2\)</span>, by <a href="../1/prob.html#thm-norm" class="quarto-xref">Theorem&nbsp;<span>2.3</span></a>, one can show that <span class="math inline">\(\frac{SSE}{\sigma^2}\sim \chi_{n-2}^2\)</span>. The loss of 2 degrees of freedom comes from estimating <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</li>
<li>Therefore <span class="math inline">\(\operatorname{E}\qty(\frac{SSE}{\sigma^2})=n-2\)</span>.</li>
<li>Therefore <span class="math inline">\(\operatorname{E}(s^2)=\frac1{n-2}\operatorname{E}(SSE)=\sigma^2\)</span>.</li>
</ul>
</details>
</div>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.4</strong></span> <span class="math display">\[
\operatorname{Var}(\hat{\beta}_1)=\frac{\sigma^2}{SS_{xx}}, \quad \operatorname{Var}(\hat{\beta}_0)=\qty(\frac{1}{n}+\frac{\bar x^2}{nSS_{xx}})\sigma^2, \quad \operatorname{Var}(s^2)=\frac{2\sigma^4}{n-2}.
\]</span></p>
<details>
<summary>
<strong>Click for proof.</strong>
</summary>
<p><span class="math display">\[
\operatorname{Var}(\hat{\beta}_1)=\frac{1}{SS_{xx}^2}\operatorname{Var}(SS_{xy})=\frac{1}{SS_{xx}^2}\operatorname{Var}\qty[\sum x_i(y_i-\bar{y})]=\frac{1}{SS_{xx}^2}SS_{xx}\sigma^2=\frac{\sigma^2}{SS_{xx}}.
\]</span></p>
<p>Since <span class="math inline">\(\operatorname{Cov}(\bar y ,\hat\beta_1)=0\)</span>, we have <span class="math display">\[
\begin{split}
\operatorname{Var}(\hat{\beta}_0)&amp;=\operatorname{Var}\qty(\bar y-\hat{\beta}_1\bar x)=\operatorname{Var}(\bar y)+\bar{x}^2\operatorname{Var}(\hat{\beta}_1)=\frac{\sigma^2}{n}+\bar x^2\frac{\sigma^2}{nSS_{xx}}=\qty(\frac{1}{n}+\frac{\bar x^2}{nSS_{xx}})\sigma^2.
\end{split}
\]</span></p>
Since <span class="math inline">\(\frac{SSE}{\sigma^2}\sim\chi^2_{n-2}\)</span>, <span class="math inline">\(\var(\frac{SSE}{\sigma^2})=2(n-2)\)</span>. Therefore <span class="math display">\[
\operatorname{Var}(s^2)=\operatorname{Var}(\frac{SSE}{n-2})=\frac1{(n-2)^2}\operatorname{Var}(SSE)=\frac1{(n-2)^2}(\sigma^2)^22(n-2)=\frac{2\sigma^4}{n-2}.
\]</span>
</details>
</div>
<p>Note that these variance formulas involve <span class="math inline">\(\sigma^2\)</span>. They come from a theoretical (population) analysis, so they can depend on unknown parameters. If we want numerical estimates of these variances from data, we must replace the unknown quantities with estimators and rebuild the variance calculations accordingly (typically by plugging in <span class="math inline">\(s^2\)</span> for <span class="math inline">\(\sigma^2\)</span>, and using the sample versions of any other unknown terms).</p>
</section>
</section>
<section id="beta_1" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="beta_1"><span class="header-section-number">5.3</span> <span class="math inline">\(\beta_1\)</span></h2>
<p>The most important question for <span class="math inline">\(\beta_1\)</span> is whether it is <span class="math inline">\(0\)</span>. In other words, we want to know whether <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have a linear relation.</p>
<ul>
<li><strong>Null hypotheis</strong>: <span class="math inline">\(H_0: \beta_1=0\)</span>.</li>
<li><strong>Alternative hypotheis</strong>: <span class="math inline">\(H_a: \beta_1\neq0\)</span>.</li>
</ul>
<p>Since <span class="math inline">\(\hat{\beta}_1=\beta_1+\sum_{i=1}^n\qty(\dfrac{x_i-\bar x}{SS_{xx}})\varepsilon_i\)</span> is normal, we could use a t-test.</p>
<p><span class="math display">\[
t=\frac{\hat{\beta}_1-0}{s_{\hat{\beta}_1}}=\frac{\hat{\beta}_1}{s/\sqrt{SS_{xx}}},\quad s^2=\frac{SSE}{n-2}
\]</span></p>
<p>We mainly use a two-tailed test. Therefore we compute the corresponding p-value, which is the probability of getting a statistic at least as extreme as the observed value, assuming <span class="math inline">\(H_0\)</span> is true. Let <span class="math inline">\(t_c=\frac{\hat\beta_1}{s/\sqrt{SS_{xx}}}\)</span> be the observed test statistic. Then</p>
<p><span class="math display">\[
p\text{-value} = \Pr(\abs{t}&gt;\abs{t_c}\mid H_0),
\]</span> where <span class="math inline">\(t\sim t_{n-2}\)</span> under <span class="math inline">\(H_0\)</span>. We reject <span class="math inline">\(H_0\)</span> if the p-value is smaller than or equal to <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li>If we reject <span class="math inline">\(H_0\)</span>, there is sufficient statistical evidence at level <span class="math inline">\(\alpha\)</span> to conclude that <span class="math inline">\(\beta_1\neq 0\)</span>. In this case, we say the linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is <strong>statistically significant</strong>.</li>
<li>If we fail to reject <span class="math inline">\(H_0\)</span>, we do not have enough evidence to determine whether <span class="math inline">\(\beta_1\)</span> differs from <span class="math inline">\(0\)</span>. In this case, we say the relationship is <strong>not statistically significant</strong>.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Failing to reject <span class="math inline">\(H_0\)</span> does not mean <span class="math inline">\(\beta_1=0\)</span>. It means there is insufficient evidence, given the data and model, to conclude that <span class="math inline">\(\beta_1\neq0\)</span>.</p>
</div>
</div>
<section id="confidence-interval" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="confidence-interval"><span class="header-section-number">5.3.1</span> Confidence interval</h3>
<p>Since <span class="math inline">\(\operatorname{Var}(\hat\beta_1)=\frac{\sigma^2}{SS+{xx}}\approx\frac{s^2}{SS_{xx}}\)</span>, the standard deviation of <span class="math inline">\(\hat\beta_1\)</span> can be estimated by <span class="math inline">\(s_{\hat\beta_1}=s/\sqrt{SS_{xx}}\)</span>. Then the <span class="math inline">\((1-\alpha)\times 100\%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span> is <span class="math display">\[
CI=\hat\beta_1\pm t_{\alpha/2,n-2}\cdot \frac{s}{\sqrt{SS_{xx}}}.
\]</span> In the hypothesis test described above, the null hypothesis is rejected if the observed <span class="math inline">\(t_c\)</span> is sufficiently extreme, that is,</p>
<p><span class="math display">\[
\abs{t_c}=\abs{\frac{\hat\beta_1}{s/\sqrt{SS_{xx}}}}&gt;t_{\alpha/2, n-2}.
\]</span> Equivalently, <span class="math display">\[
\abs{\hat\beta_1}&gt;t_{\alpha/2, n-2}\cdot \frac{s}{\sqrt{SS_{xx}}}.
\]</span> Therefore it means that rejecting null hypothesis is the same as the confidence interval of <span class="math inline">\(\beta_1\)</span> doesn‚Äôt contain 0.</p>
</section>
</section>
<section id="sum-of-squares" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sum-of-squares"><span class="header-section-number">5.4</span> Sum of squares</h2>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.5 (The fundamental ANOVA identity)</strong></span> Define</p>
<ul>
<li><span class="math inline">\(SSE=\sum (y_i-\hat y_i)^2\)</span>: sum of squared errors</li>
<li><span class="math inline">\(SSR=\sum (\hat y_i-\bar y)^2\)</span>: sum of squares regression</li>
<li><span class="math inline">\(SST=\sum (y_i-\bar y)^2\)</span>: sum of squares total (also denoted <span class="math inline">\(SS_{yy}\)</span>)</li>
</ul>
<p>These quantities satisfy <span class="math display">\[
SST = SSR+SSE.
\]</span></p>
<details>
<summary>
<strong>Click for proof.</strong>
</summary>
<span class="math display">\[
\begin{split}
SSR&amp;=\sum (\hat y_i-\bar y)^2=\sum (\hat\beta_0+\hat\beta_1x_i-\bar y)^2=\sum (\bar y-\hat\beta_1\bar x+\hat\beta_1x_i-\bar y)^2\\
&amp;=\sum (\hat\beta_1(x_i-\bar x))^2=(\hat\beta_1)^2\sum (x_i-\bar x)^2\\
&amp;=\frac{SS_{xy}^2}{SS_{xx}^2}SS_{xx}=\frac{SS_{xy}^2}{SS_{xx}},\\
SSE&amp;=\sum ( y_i-\hat y_i)^2=\sum (y_i-\hat\beta_0-\hat\beta_1x_i)^2=\sum (y_i-\bar y+\hat\beta_1\bar x-\hat\beta_1x_i)^2\\
&amp;=\sum ((y_i-\bar y)-\hat\beta_1(x_i-\bar x))^2=\sum (y_i-\bar y)^2-2\hat\beta_1(x_i-\bar x)(y_i-\bar y)+(\hat\beta_1(x_i-\bar x))^2\\
&amp;=\sum (y_i-\bar y)^2-2\hat\beta_1\sum(x_i-\bar x)(y_i-\bar y)+(\hat\beta_1)^2\sum(x_i-\bar x)^2\\
&amp;=SST-2\frac{SS_{xy}}{SS_{xx}}SS_{xy}+\qty(\frac{SS_{xy}}{SS_{xx}})^2SS_{xx}\\
&amp;=SST-2\frac{SS_{xy}^2}{SS_{xx}}+\frac{SS_{xy}^2}{SS_{xx}}=SST-\frac{SS_{xy}^2}{SS_{xx}}\\
&amp;=SST-SSR.
\end{split}
\]</span> Therefore <span class="math display">\[
SST=SSR+SSE.
\]</span>
</details>
</div>
<p>These three qualities are essential in interepretating regression models.</p>
<ul>
<li>SST measures the total variability in the response variable.</li>
<li>SSR measures the variation explained by the regression model.</li>
<li>SSE measures the unexplained (residual) variation.</li>
</ul>
<p>SSR measures the variation explained by the regression model. Since this variation is captured by the fitted regression line, it is considered explained by the model. The total variance is described by SST. So we would like the portion that is explained by our model is as high as possible. In other words, we would like <span class="math inline">\(SSR/SST\)</span> is as high as possible. Since it is very important, we assign a variable to it.</p>
</section>
<section id="coefficient-of-determination" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="coefficient-of-determination"><span class="header-section-number">5.5</span> Coefficient of Determination</h2>
<p>The coefficient of determination is defined as <span class="math display">\[
r^2=\frac{SST-SSE}{SST}=1-\frac{SSE}{SST}=\frac{SSR}{SST}
\]</span> It represents the proportion of the total sample variability in <span class="math inline">\(ùëå\)</span> that is explained by the linear relationship between <span class="math inline">\(ùëå\)</span> and <span class="math inline">\(X\)</span>. Equivalently, we have the following statement.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><span class="math inline">\(r^2\)</span> interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>About <span class="math inline">\(100(r^2)\%\)</span> of the total variation in the sample <span class="math inline">\(y\)</span>-values (measured by the total sum of squares about <span class="math inline">\(\bar y\)</span>) can be explained by using <span class="math inline">\(X\)</span> to predict <span class="math inline">\(Y\)</span> in the simple linear regression model.</p>
</div>
</div>
</section>
<section id="coefficent-of-correlation" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="coefficent-of-correlation"><span class="header-section-number">5.6</span> Coefficent of Correlation</h2>
<p>Recall that the Pearson coefficent of correlation is defined as follows. <span class="math display">\[
r=\frac{SS_{xy}}{\sqrt{SS_{xx}SS_{yy}}}.
\]</span></p>
<p>Since <span class="math inline">\(\hat\beta_1=\frac{SS_{xy}}{SS_{xx}}\)</span>, we have</p>
<p><span class="math display">\[
r=\hat\beta_1\frac{\sqrt{SS_{xx}}}{\sqrt{SS_{yy}}}=\hat\beta_1\frac{s_x}{s_y}
\]</span> where <span class="math inline">\(s_x\)</span> and <span class="math inline">\(s_y\)</span> are the sample standard deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. This suggests that <span class="math inline">\(r\)</span> is the standarized slope, while <span class="math inline">\(\hat\beta_1\)</span> dependes on the units of measurement of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>This <span class="math inline">\(r\)</span> and the previous <span class="math inline">\(r^2\)</span> is related. <span class="math display">\[
\abs{r}=\frac{SS_{xy}}{\sqrt{SS_{xx}SS_{yy}}}=\sqrt{\frac{SS_{xy}^2}{SS_{xx}SS_{yy}}}=\sqrt{\frac{SSR}{SST}}=\sqrt{r^2}.
\]</span> This is the reason we choose these notations. Note that I ignore the sign of <span class="math inline">\(r\)</span> in this computation. When using <span class="math inline">\(\sqrt{r^2}\)</span> to compute <span class="math inline">\(r\)</span>, we have to manually choose the sign for <span class="math inline">\(r\)</span> based on other indicators.</p>
<p>Since <span class="math inline">\(r\)</span> and <span class="math inline">\(\beta_1\)</span> essentially describe the same linear relationship, we can also use <span class="math inline">\(r\)</span> to perform the hypothesis test. We have <span class="math display">\[
t=\frac{\hat\beta_1}{s/\sqrt{SS_{xx}}}=\frac{\hat\beta_1 \sqrt{SS_{xx}}}{s}=r \sqrt{\frac{SS_{yy}}{SSE/(n-2)}}=r\sqrt{n-2}/{\sqrt{1-r^2}}
\]</span></p>
</section>
<section id="the-anova-table" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="the-anova-table"><span class="header-section-number">5.7</span> The ANOVA table</h2>
<p>Now that we have defined these sums of squares, they are typically organized into an ANOVA Table. This table provides a convenient summary for assessing the overall significance of the regression model using the F-test.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 25%">
<col style="width: 31%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>df</th>
<th>Sum of Squares (SS)</th>
<th>Mean Square (MS)</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td>1</td>
<td>SSR</td>
<td>MSR = SSR / 1</td>
<td>F = MSR / MSE</td>
</tr>
<tr class="even">
<td>Error</td>
<td>n ‚àí 2</td>
<td>SSE</td>
<td>MSE = SSE / (n ‚àí 2)</td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td>n ‚àí 1</td>
<td>SST</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The F-test examines whether the regression model, as a whole, explains a significant portion of the variability in the response variable. In the case of simple linear regression which only contains one independent variable, the F-test and the t-test are equivalent. In particular, the F-statistic is exactly the square of the corresponding t-statistic:</p>
<p><span class="math display">\[
F=t^2.
\]</span></p>
<p>We will discuss the F-test in more details when we move on to multiple linear regression (MLR).</p>
</section>
<section id="prediction-interval-and-confidence-interval" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="prediction-interval-and-confidence-interval"><span class="header-section-number">5.8</span> Prediction interval and Confidence interval</h2>
<p>When using a regression model, we need to quantify how uncertain our predictions are. There are two different types of intervals, depending on what we wish to estimate:</p>
<ul>
<li>a <strong>confidence interval</strong> for the mean response <span class="math inline">\(\operatorname{E}(Y\mid X=x)\)</span></li>
<li>a <strong>prediction interval</strong> for a new individual observation <span class="math inline">\(Y\mid X=x\)</span>.</li>
</ul>
<section id="estimate-the-variance" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="estimate-the-variance"><span class="header-section-number">5.8.1</span> Estimate the variance</h3>
<p>First a preliminary result is that <span class="math inline">\(\bar y\)</span> and <span class="math inline">\(\hat\beta_1\)</span> as random variables are uncorrelated (covariance is 0).</p>
<div id="lem-" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 5.1</strong></span> <span class="math inline">\(\operatorname{Cov}(\bar y, \hat\beta_1)=0\)</span>.</p>
<details>
<summary>
<strong>Click for proof.</strong>
</summary>
<p><span class="math display">\[
\begin{split}
\bar y&amp;=\beta_0+\beta_1\bar x+\bar\varepsilon,\\
\hat\beta_1&amp;=\frac{1}{SS_{xx}}\sum_{i=1}^n(x_i-\bar x)(y_i-\bar y)=\frac1{SS_{xx}}\sum_{i=1}^n(x_i-\bar x)y_i\\
&amp;=\frac1{SS_{xx}}\sum_{i=1}^n(x_i-\bar x)(\beta_0+\beta_1x_i+\varepsilon_i)\\
&amp;=\frac1{SS_{xx}}\sum_{i=1}^n(x_i-\bar x)(\beta_0+\beta_1x_i)+\frac1{SS_{xx}}\sum_{i=1}^n(x_i-\bar x)\varepsilon_i.
\end{split}
\]</span> Since <span class="math inline">\(\beta_0+\beta_1\bar x\)</span> and <span class="math inline">\(\frac1{SS_{xx}}\sum_{i=1}^n(x_i-\bar x)(\beta_0+\beta_1x_i)\)</span> are considered as constants, we have <span class="math display">\[
\begin{split}
\operatorname{Cov}(\bar y,\hat\beta_1)&amp;=\operatorname{Cov}(\bar\varepsilon, \sum_{i=1}^n(x_i-\bar x)\varepsilon_i)=\operatorname{Cov}(\sum_{j=1}^n\varepsilon_j, \sum_{i=1}^n(x_i-\bar x)\varepsilon_i)\\
&amp;=\sum_{i,j=1}^n\operatorname{Cov}(\varepsilon_j, (x_i-\bar x)\varepsilon_i)=\sum_{i=1}^n\operatorname{Cov}(\varepsilon_i, (x_i-\bar x)\varepsilon_i)\\
&amp;=\sum_{i=1}^n(x_i-\bar x)=0.
\end{split}
\]</span></p>
</details>
</div>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.6</strong></span> Let <span class="math inline">\(x\)</span> be a fixed value.</p>
<ol type="1">
<li>The variance of the estimated mean response is <span class="math display">\[
\operatorname{Var}(\operatorname{E}(y))=\sigma^2\qty[\frac1n+\frac{(x-\bar x)^2}{S_{xx}}].
\]</span></li>
<li>The variance of a new observation is <span class="math display">\[
\operatorname{Var}(y)=\sigma^2\qty[1+\frac1n+\frac{(x-\bar x)^2}{S_{xx}}].
\]</span></li>
</ol>
<details>
<summary>
<strong>Click for proof.</strong>
</summary>
<p>Since <span class="math inline">\(\bar y\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are uncorrelated, we have <span class="math display">\[
\begin{split}
\operatorname{Var}(\operatorname{E}(y))&amp;=\operatorname{Var}(\hat\beta_0+\hat\beta_1x)=\operatorname{Var}(\bar y+\hat\beta_1(x-\bar x))=\operatorname{Var}(\bar y)+(x-\bar x)^2\operatorname{Var}(\hat\beta_1)\\
&amp;=\frac1n\sigma^2+(x-\bar x)^2\frac{\sigma^2}{SS_{xx}}\\
&amp;=\sigma^2\qty[\frac1n+\frac{(x-\bar x)^2}{SS_{xx}}],\\
\operatorname{Var}(y)&amp;=\operatorname{Var}(\operatorname{E}(y)+\varepsilon)=\operatorname{Var}(\operatorname{E}(y))+\operatorname{Var}(\varepsilon)=\sigma^2\qty[\frac1n+\frac{(x-\bar x)^2}{SS_{xx}}]+\sigma^2\\
&amp;=\sigma^2\qty[1+\frac1n+\frac{(x-\bar x)^2}{S_{xx}}].
\end{split}
\]</span></p>
</details>
</div>
<p>Therefore, these two variances lead to:</p>
<ul>
<li>a confidence interval for <span class="math inline">\(\operatorname{E}(Y\mid X=x)\)</span></li>
<li>a prediction interval for a new <span class="math inline">\(Y\mid X=x\)</span>.</li>
</ul>
<p>The prediction interval is always wider, because it includes both estimation uncertainty and irreducible error.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../contents/2/intro.html" class="pagination-link" aria-label="Intro to regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intro to regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../contents/2/rcode.html" class="pagination-link" aria-label="R Code">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R Code</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>